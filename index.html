<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Reels OTT</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
*{margin:0;padding:0;box-sizing:border-box}
body{
  background:#0e0e0e;
  color:#fff;
  font-family:system-ui,-apple-system,Segoe UI,Roboto;
}

/* HEADER */
header{
  position:sticky;
  top:0;
  z-index:10;
  background:#111;
  padding:12px 14px;
  display:flex;
  align-items:center;
  gap:10px;
  border-bottom:1px solid #222;
}
.logo{font-weight:800;font-size:18px}
.search{flex:1}
.search input{
  width:100%;
  padding:8px 10px;
  border-radius:8px;
  border:none;
  outline:none;
  background:#1c1c1c;
  color:#fff;
}

/* GRID */
.grid{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:10px;
  padding:12px;
}
.card img{
  width:100%;
  aspect-ratio:2/3;
  object-fit:cover;
  border-radius:10px;
}
.card h4{font-size:13px;margin-top:4px}

/* EMPTY / ERROR */
.notice{
  padding:30px;
  text-align:center;
  color:#aaa;
  font-size:14px;
}

/* FOOTER */
footer{
  padding:14px;
  text-align:center;
  font-size:12px;
  color:#aaa;
  border-top:1px solid #222;
}

/* REELS */
.reels{
  position:fixed;
  inset:0;
  background:#000;
  display:none;
  overflow-y:auto;
  scroll-snap-type:y mandatory;
  z-index:99;
}
.reel{height:100vh;scroll-snap-align:start}
.reel video{width:100%;height:100%;object-fit:cover}
.close{
  position:fixed;
  top:12px;
  right:14px;
  font-size:26px;
  cursor:pointer;
  z-index:999;
}
</style>
</head>

<body>

<!-- HEADER ALWAYS VISIBLE -->
<header>
  <div class="logo">ðŸŽ¬ ReelsOTT</div>
  <div class="search">
    <input id="searchInput" placeholder="Search reelsâ€¦">
  </div>
</header>

<!-- GRID -->
<div id="grid" class="grid"></div>

<!-- MESSAGE -->
<div id="notice" class="notice">
  Loading postsâ€¦
</div>

<!-- FOOTER ALWAYS VISIBLE -->
<footer>
  Â© 2026 ReelsOTT â€¢ GitHub Pages
</footer>

<!-- REELS -->
<div class="reels" id="reels">
  <div class="close" onclick="closeReels()">âœ•</div>
  <div id="reelWrap"></div>
</div>

<script>
let allPosts=[];

/* LOAD POSTS SAFELY (NO BLANK) */
fetch("posts/index.json")
.then(r=>{
  if(!r.ok) throw "index.json not found";
  return r.json();
})
.then(slugs=>{
  return Promise.all(
    slugs.map(s =>
      fetch("posts/"+s+".json").then(r=>{
        if(!r.ok) throw s+" missing";
        return r.json();
      })
    )
  );
})
.then(data=>{
  allPosts=data;
  render(data);
})
.catch(err=>{
  document.getElementById("notice").innerText =
    "No posts found or data error";
  console.error(err);
});

/* RENDER */
function render(list){
  const grid=document.getElementById("grid");
  const reelWrap=document.getElementById("reelWrap");
  const notice=document.getElementById("notice");
  grid.innerHTML="";
  reelWrap.innerHTML="";
  notice.style.display="none";

  list.forEach((p,i)=>{
    grid.innerHTML+=`
      <div class="card" onclick="openReels(${i})">
        <img src="${p.poster}">
        <h4>${p.title}</h4>
      </div>`;
    reelWrap.innerHTML+=`
      <div class="reel">
        <video src="${p.video}" muted loop playsinline></video>
      </div>`;
  });
}

/* SEARCH */
document.getElementById("searchInput").oninput=function(){
  const q=this.value.toLowerCase();
  render(allPosts.filter(p=>p.title.toLowerCase().includes(q)));
};

/* REELS */
const reels=document.getElementById("reels");
function openReels(i){
  reels.style.display="block";
  reels.scrollTo(0,i*innerHeight);
}
function closeReels(){
  reels.style.display="none";
}
</script>

</body>
</html>
