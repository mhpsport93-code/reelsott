<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>ReelsOTT</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
*{box-sizing:border-box;margin:0;padding:0}

body{
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;
  background:#0e0e0e;
  color:#fff;
  min-height:100vh;
}

/* ================= HEADER ================= */
header{
  display:flex;
  align-items:center;
  gap:12px;
  padding:14px 16px;
  background:#111;
  border-bottom:1px solid #222;
}

.logo{
  font-weight:800;
  font-size:18px;
  white-space:nowrap;
}

.search{
  flex:1;
}

.search input{
  width:100%;
  padding:10px 14px;
  border-radius:999px;
  border:none;
  outline:none;
  background:#1c1c1c;
  color:#fff;
  font-size:14px;
}

/* ================= GRID ================= */
.grid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(150px,1fr));
  gap:14px;
  padding:14px;
}

.card{
  background:#181818;
  border-radius:14px;
  overflow:hidden;
  cursor:pointer;
  transition:.2s;
}

.card:hover{
  transform:scale(1.03);
}

.card img{
  width:100%;
  height:220px;
  object-fit:cover;
  display:block;
}

.card h3{
  font-size:14px;
  font-weight:600;
  padding:8px 10px 10px;
  line-height:1.3;
}

/* ================= MESSAGE ================= */
.msg{
  text-align:center;
  opacity:.6;
  padding:40px 16px;
  font-size:14px;
}

/* ================= FOOTER ================= */
footer{
  text-align:center;
  padding:14px;
  font-size:13px;
  color:#aaa;
  border-top:1px solid #222;
}
</style>
</head>

<body>

<header>
  <div class="logo">ðŸŽ¬ ReelsOTT</div>
  <div class="search">
    <input id="search" placeholder="Search reels...">
  </div>
</header>

<div id="grid" class="grid"></div>
<div id="msg" class="msg" style="display:none"></div>

<footer>
  Â© 2026 ReelsOTT â€¢ GitHub Pages
</footer>

<script>
/* ===== BASE PATH FIX (LOCAL + GITHUB PAGES) ===== */
const BASE = location.pathname.includes('/reelsott/')
  ? '/reelsott/'
  : '/';

const grid = document.getElementById('grid');
const msg  = document.getElementById('msg');
const searchInput = document.getElementById('search');

let allPosts = [];

/* ===== LOAD POSTS INDEX ===== */
fetch(BASE + 'posts/index.json')
  .then(r => {
    if(!r.ok) throw 'index.json not found';
    return r.json();
  })
  .then(slugs => {
    if(!Array.isArray(slugs) || !slugs.length) {
      throw 'empty index';
    }

    Promise.all(
      slugs.map(slug =>
        fetch(BASE + 'posts/' + slug + '.json')
          .then(r => r.json())
          .then(data => ({ slug, ...data }))
      )
    ).then(posts => {
      allPosts = posts;
      render(posts);
    });
  })
  .catch(() => {
    msg.style.display = 'block';
    msg.innerText = 'No posts found or data error';
  });

/* ===== RENDER GRID ===== */
function render(list){
  grid.innerHTML = '';
  msg.style.display = list.length ? 'none' : 'block';

  if(!list.length){
    msg.innerText = 'No matching posts';
    return;
  }

  list.forEach(p => {
    const card = document.createElement('div');
    card.className = 'card';
    card.innerHTML = `
      <img src="${p.poster}" loading="lazy">
      <h3>${p.title}</h3>
    `;
    card.onclick = () => {
      alert(
        'Reel click demo\\n\\nTitle: ' + p.title +
        '\\n\\nNext step: yahan reel player open karenge'
      );
    };
    grid.appendChild(card);
  });
}

/* ===== SEARCH ===== */
searchInput.addEventListener('input', e => {
  const q = e.target.value.toLowerCase();
  render(
    allPosts.filter(p =>
      p.title.toLowerCase().includes(q)
    )
  );
});
</script>

</body>
</html>
